import{O as z,V as p,M as g}from"./three.module.81fc2a6a.js";class W extends z{constructor(l=document.createElement("div")){super(),this.element=l,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(l,i){return super.copy(l,i),this.element=l.element.cloneNode(!0),this}}W.prototype.isCSS2DObject=!0;const o=new p,y=new g,S=new g,v=new p,M=new p;class q{constructor(l={}){const i=this;let h,f,u,c;const m={objects:new WeakMap},d=l.element!==void 0?l.element:document.createElement("div");d.style.overflow="hidden",this.domElement=d,this.getSize=function(){return{width:h,height:f}},this.render=function(e,t){e.autoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.updateMatrixWorld(),y.copy(t.matrixWorldInverse),S.multiplyMatrices(t.projectionMatrix,y),x(e,e,t),_(e)},this.setSize=function(e,t){h=e,f=t,u=h/2,c=f/2,d.style.width=e+"px",d.style.height=t+"px"};function x(e,t,r){if(e.isCSS2DObject){o.setFromMatrixPosition(e.matrixWorld),o.applyMatrix4(S);const n=e.visible===!0&&o.z>=-1&&o.z<=1&&e.layers.test(r.layers)===!0;if(e.element.style.display=n===!0?"":"none",n===!0){e.onBeforeRender(i,t,r);const a=e.element;/apple/i.test(navigator.vendor)?a.style.transform="translate(-50%,-50%) translate("+Math.round(o.x*u+u)+"px,"+Math.round(-o.y*c+c)+"px)":a.style.transform="translate(-50%,-50%) translate("+(o.x*u+u)+"px,"+(-o.y*c+c)+"px)",a.parentNode!==d&&d.appendChild(a),e.onAfterRender(i,t,r)}const s={distanceToCameraSquared:O(r,e)};m.objects.set(e,s)}for(let n=0,s=e.children.length;n<s;n++)x(e.children[n],t,r)}function O(e,t){return v.setFromMatrixPosition(e.matrixWorld),M.setFromMatrixPosition(t.matrixWorld),v.distanceToSquared(M)}function C(e){const t=[];return e.traverse(function(r){r.isCSS2DObject&&t.push(r)}),t}function _(e){const t=C(e).sort(function(n,s){if(n.renderOrder!==s.renderOrder)return s.renderOrder-n.renderOrder;const a=m.objects.get(n).distanceToCameraSquared,D=m.objects.get(s).distanceToCameraSquared;return a-D}),r=t.length;for(let n=0,s=t.length;n<s;n++)t[n].element.style.zIndex=r-n}}}export{W as CSS2DObject,q as CSS2DRenderer};
