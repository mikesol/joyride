import{V as E,Q as N,O as R,M as O}from"./three.module.81fc2a6a.js";const M=new E,I=new N,w=new E;class _ extends R{constructor(r=document.createElement("div")){super(),this.element=r,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(r,i){return super.copy(r,i),this.element=r.element.cloneNode(!0),this}}_.prototype.isCSS3DObject=!0;class k extends _{constructor(r){super(r),this.rotation2D=0}copy(r,i){return super.copy(r,i),this.rotation2D=r.rotation2D,this}}k.prototype.isCSS3DSprite=!0;const l=new O,z=new O;class H{constructor(r={}){const i=this;let u,h,S,f;const m={camera:{fov:0,style:""},objects:new WeakMap},c=r.element!==void 0?r.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c;const a=document.createElement("div");a.style.transformStyle="preserve-3d",a.style.pointerEvents="none",c.appendChild(a),this.getSize=function(){return{width:u,height:h}},this.render=function(n,e){const s=e.projectionMatrix.elements[5]*f;m.camera.fov!==s&&(c.style.perspective=e.isPerspectiveCamera?s+"px":"",m.camera.fov=s),n.autoUpdate===!0&&n.updateMatrixWorld(),e.parent===null&&e.updateMatrixWorld();let y,o;e.isOrthographicCamera&&(y=-(e.right+e.left)/2,o=(e.top+e.bottom)/2);const p=(e.isOrthographicCamera?"scale("+s+")translate("+t(y)+"px,"+t(o)+"px)"+v(e.matrixWorldInverse):"translateZ("+s+"px)"+v(e.matrixWorldInverse))+"translate("+S+"px,"+f+"px)";m.camera.style!==p&&(a.style.transform=p,m.camera.style=p),D(n,n,e)},this.setSize=function(n,e){u=n,h=e,S=u/2,f=h/2,c.style.width=n+"px",c.style.height=e+"px",a.style.width=n+"px",a.style.height=e+"px"};function t(n){return Math.abs(n)<1e-10?0:n}function v(n){const e=n.elements;return"matrix3d("+t(e[0])+","+t(-e[1])+","+t(e[2])+","+t(e[3])+","+t(e[4])+","+t(-e[5])+","+t(e[6])+","+t(e[7])+","+t(e[8])+","+t(-e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(-e[13])+","+t(e[14])+","+t(e[15])+")"}function C(n){const e=n.elements,s="matrix3d("+t(e[0])+","+t(e[1])+","+t(e[2])+","+t(e[3])+","+t(-e[4])+","+t(-e[5])+","+t(-e[6])+","+t(-e[7])+","+t(e[8])+","+t(e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(e[13])+","+t(e[14])+","+t(e[15])+")";return"translate(-50%,-50%)"+s}function D(n,e,s,y){if(n.isCSS3DObject){const o=n.visible===!0&&n.layers.test(s.layers)===!0;if(n.element.style.display=o===!0?"":"none",o===!0){n.onBeforeRender(i,e,s);let d;n.isCSS3DSprite?(l.copy(s.matrixWorldInverse),l.transpose(),n.rotation2D!==0&&l.multiply(z.makeRotationZ(n.rotation2D)),n.matrixWorld.decompose(M,I,w),l.setPosition(M),l.scale(w),l.elements[3]=0,l.elements[7]=0,l.elements[11]=0,l.elements[15]=1,d=C(l)):d=C(n.matrixWorld);const p=n.element,g=m.objects.get(n);if(g===void 0||g.style!==d){p.style.transform=d;const W={style:d};m.objects.set(n,W)}p.parentNode!==a&&a.appendChild(p),n.onAfterRender(i,e,s)}}for(let o=0,d=n.children.length;o<d;o++)D(n.children[o],e,s)}}}export{_ as CSS3DObject,H as CSS3DRenderer,k as CSS3DSprite};
