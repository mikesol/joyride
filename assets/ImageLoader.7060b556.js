import{c as L}from"./utils.4cfc5b76.js";const l={enabled:!1,files:{},add:function(a,e){this.enabled!==!1&&(this.files[a]=e)},get:function(a){if(this.enabled!==!1)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class E{constructor(e,d,c){const n=this;let i=!1,f=0,s=0,h;const o=[];this.onStart=void 0,this.onLoad=e,this.onProgress=d,this.onError=c,this.itemStart=function(t){s++,i===!1&&n.onStart!==void 0&&n.onStart(t,f,s),i=!0},this.itemEnd=function(t){f++,n.onProgress!==void 0&&n.onProgress(t,f,s),f===s&&(i=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(t){n.onError!==void 0&&n.onError(t)},this.resolveURL=function(t){return h?h(t):t},this.setURLModifier=function(t){return h=t,this},this.addHandler=function(t,r){return o.push(t,r),this},this.removeHandler=function(t){const r=o.indexOf(t);return r!==-1&&o.splice(r,2),this},this.getHandler=function(t){for(let r=0,m=o.length;r<m;r+=2){const u=o[r],g=o[r+1];if(u.global&&(u.lastIndex=0),u.test(t))return g}return null}}}const p=new E;class v{constructor(e){this.manager=e!==void 0?e:p,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,d){const c=this;return new Promise(function(n,i){c.load(e,n,d,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}class O extends v{constructor(e){super(e)}load(e,d,c,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,f=l.get(e);if(f!==void 0)return i.manager.itemStart(e),setTimeout(function(){d&&d(f),i.manager.itemEnd(e)},0),f;const s=L("img");function h(){t(),l.add(e,this),d&&d(this),i.manager.itemEnd(e)}function o(r){t(),n&&n(r),i.manager.itemError(e),i.manager.itemEnd(e)}function t(){s.removeEventListener("load",h,!1),s.removeEventListener("error",o,!1)}return s.addEventListener("load",h,!1),s.addEventListener("error",o,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}export{O as I,v as L};
